# Кешування Дашборду

## Що було зроблено

Налаштовано систему кешування для дашборду, яка:
- ✅ **Показує дані миттєво з кешу**
- ✅ **Оновлює дані кожну хвилину в фоні**
- ✅ **Зберігає кеш в localStorage** (дані доступні навіть після перезавантаження сторінки)
- ✅ **Показує індикатор оновлення** коли дані завантажуються в фоні

## Зміни в коді

### 1. Оновлено `hooks/useQueries.ts`

Налаштовано React Query хуки для автоматичного кешування:

```typescript
// useStats() - оновлюється кожну хвилину
staleTime: 60 * 1000,              // Дані свіжі 1 хвилину
refetchInterval: 60 * 1000,        // Автооновлення кожну хвилину
refetchOnMount: false,             // Не робити зайвих запитів

// useProjects() - так само
// useTasks() - так само
```

### 2. Створено `hooks/useDashboardCache.ts`

Новий хук для керування кешем:
- Автоматично інвалідує застарілі дані
- Надає функції для ручного оновлення
- `refreshStats()`, `refreshProjects()`, `refreshAll()`

### 3. Оновлено `lib/queryClient.ts`

Глобальні налаштування React Query:
```typescript
staleTime: 60 * 1000,              // 1 хвилина за замовчуванням
refetchOnMount: false,             // Не рефетчити якщо дані свіжі
refetchOnWindowFocus: 'always',    // Оновлювати при поверненні на вкладку
```

### 4. Оновлено `dashboard/page.tsx`

Додано:
- Використання `useDashboardCache()`
- Індикатор фонового оновлення "Updating..."
- Відстеження стану `isBackgroundFetching`

## Як це працює

### Перше завантаження
1. Користувач відкриває дашборд
2. Дані завантажуються з API
3. Дані зберігаються в React Query кеш
4. Дані зберігаються в localStorage

### Наступні завантаження
1. Користувач відкриває дашборд
2. **Миттєво показуються дані з кешу** (з localStorage)
3. В фоні запускається запит на оновлення
4. Коли нові дані приходять - UI оновлюється плавно
5. Показується індикатор "Updating..." поки завантажуються нові дані

### Автоматичне оновлення
- Кожну хвилину React Query автоматично робить запит на оновлення
- Якщо користувач на сторінці - дані оновлюються
- Якщо користувач не на сторінці - запити призупиняються

### Переваги

✅ **Швидкість**: Дані показуються миттєво з кешу
✅ **Актуальність**: Автоматичне оновлення кожну хвилину
✅ **Офлайн**: Дані доступні навіть без інтернету (з кешу)
✅ **UX**: Плавні оновлення без мерехтіння
✅ **Продуктивність**: Менше навантаження на сервер

## Налаштування

Якщо потрібно змінити інтервал оновлення:

```typescript
// В hooks/useQueries.ts
refetchInterval: 30 * 1000,  // 30 секунд
refetchInterval: 2 * 60 * 1000,  // 2 хвилини
```

Якщо потрібно вимкнути автооновлення:

```typescript
refetchInterval: false,  // Вимкнути
```
