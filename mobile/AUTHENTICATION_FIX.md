# ‚úÖ Mobile App Authentication - FULLY FIXED

## –î–∞—Ç–∞: 2025-12-06

## –ü—Ä–æ–±–ª–µ–º–∏ —Ç–∞ –†—ñ—à–µ–Ω–Ω—è

### 1. ‚ùå –í—ñ–¥—Å—É—Ç–Ω—ñ API –∫–ª—é—á—ñ (–ö–†–ò–¢–ò–ß–ù–û)
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –º–∞–≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Service-API-Key`, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–µ–Ω –≤—Å—ñ–º backend —Å–µ—Ä–≤—ñ—Å–∞–º. –¶–µ –≤–∏–∫–ª–∏–∫–∞–ª–æ –ø–æ–º–∏–ª–∫—É 401 –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º "Service API key is required".

**–†—ñ—à–µ–Ω–Ω—è**:
- ‚úÖ –î–æ–¥–∞–Ω–æ `EXPO_PUBLIC_*_SERVICE_API_KEY` –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è –≤ `.env`
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ —Ñ–∞–π–ª–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Service-API-Key`
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —Ç–æ–π —Å–∞–º–∏–π API –∫–ª—é—á, —â–æ –π –≤ dashboard

**–ó–º—ñ–Ω–µ–Ω—ñ —Ñ–∞–π–ª–∏**:
- `mobile/.env` - –î–æ–¥–∞–Ω–æ API –∫–ª—é—á—ñ
- `mobile/.env.example` - –î–æ–¥–∞–Ω–æ API –∫–ª—é—á—ñ
- `mobile/lib/auth-service.ts` - –î–æ–¥–∞–Ω–æ X-Service-API-Key header
- `mobile/lib/project-service.ts` - –î–æ–¥–∞–Ω–æ X-Service-API-Key header
- `mobile/lib/task-service.ts` - –î–æ–¥–∞–Ω–æ X-Service-API-Key header
- `mobile/lib/team-service.ts` - –î–æ–¥–∞–Ω–æ X-Service-API-Key header

### 2. ‚ùå –ñ–æ—Ä—Å—Ç–∫–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ URL —Å–µ—Ä–≤—ñ—Å—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å—ñ —Ñ–∞–π–ª–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤ –º–∞–ª–∏ –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ production URLs –∑–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è.

**–†—ñ—à–µ–Ω–Ω—è**:
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `process.env.EXPO_PUBLIC_*_SERVICE_URL`
- ‚úÖ –î–æ–¥–∞–Ω–æ fallback –¥–æ production URLs

### 3. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –æ—Ç–æ—á–µ–Ω–Ω—è
**–ü—Ä–æ–±–ª–µ–º–∞**: –§–∞–π–ª `.env` –±—É–≤ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –∑ localhost URLs, —è–∫—ñ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö.

**–†—ñ—à–µ–Ω–Ω—è**:
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ `.env` –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è production URLs –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
- ‚úÖ –î–æ–¥–∞–Ω–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏

### 4. ‚ùå –ì–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
**–ü—Ä–æ–±–ª–µ–º–∞**: `useAuth` –±—É–≤ —Ö—É–∫–æ–º, —è–∫–∏–π —Å—Ç–≤–æ—Ä—é–≤–∞–≤ –æ–∫—Ä–µ–º–∏–π —Å—Ç–∞–Ω –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ª–æ–≥—ñ–Ω—É `AuthGuard` –Ω–µ –∑–Ω–∞–≤ –ø—Ä–æ –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É —ñ –ø–æ–≤–µ—Ä—Ç–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –µ–∫—Ä–∞–Ω –ª–æ–≥—ñ–Ω—É.

**–†—ñ—à–µ–Ω–Ω—è**:
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `AuthContext` (Context API) –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- ‚úÖ –û–±–≥–æ—Ä–Ω—É—Ç–æ –¥–æ–¥–∞—Ç–æ–∫ –≤ `AuthProvider`
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `useAuth` –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–ó–º—ñ–Ω–µ–Ω—ñ —Ñ–∞–π–ª–∏**:
- `mobile/contexts/AuthContext.tsx` - –ù–æ–≤–∏–π —Ñ–∞–π–ª –∑ –≥–ª–æ–±–∞–ª—å–Ω–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- `mobile/app/_layout.tsx` - –î–æ–¥–∞–Ω–æ AuthProvider
- `mobile/app/(auth)/login.tsx` - –û–Ω–æ–≤–ª–µ–Ω–æ import
- `mobile/app/(auth)/signup.tsx` - –û–Ω–æ–≤–ª–µ–Ω–æ import
- `mobile/app/(tabs)/*.tsx` - –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ imports (6 —Ñ–∞–π–ª—ñ–≤)

### 5. ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
**–î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤**:
- Auth Service: –ª–æ–≥—É–≤–∞–Ω–Ω—è —Å–ø—Ä–æ–± –ª–æ–≥—ñ–Ω—É, —É—Å–ø—ñ—Ö—É/–ø–æ–º–∏–ª–æ–∫
- Project Service: –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ headers
- Task Service: –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ headers
- Team Service: –±–∞–∑–æ–≤–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- AuthContext: –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞–Ω—É

## –ü–æ—Ç–æ—á–Ω–∞ –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### Production URLs (–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
```env
EXPO_PUBLIC_AUTH_SERVICE_URL=https://flow-auth-service.vercel.app
EXPO_PUBLIC_USER_SERVICE_URL=https://flow-user-service.vercel.app
EXPO_PUBLIC_PROJECT_SERVICE_URL=https://flow-project-service.vercel.app
EXPO_PUBLIC_TASK_SERVICE_URL=https://flow-task-service.vercel.app
EXPO_PUBLIC_TEAM_SERVICE_URL=https://flow-team-service.vercel.app
```

### API –ö–ª—é—á—ñ (–û–±–æ–≤'—è–∑–∫–æ–≤—ñ) - –ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—î —Å–≤—ñ–π –∫–ª—é—á!
```env
EXPO_PUBLIC_AUTH_SERVICE_API_KEY=ea2a45bbaa25e45f2bb8f1cb2d7997f19524a5edbae5f9d476053577e17bd8c9
EXPO_PUBLIC_PROJECT_SERVICE_API_KEY=74e6a18738805e921aca6277c254fec93b27753eca26923803d014654b0f8438
EXPO_PUBLIC_TASK_SERVICE_API_KEY=d4e53b8990758895c08c46d2d270d7b0e3c00d17f6b9ef473d40580b0afb0f58
EXPO_PUBLIC_TEAM_SERVICE_API_KEY=7b60018b5f5da191d487949ac91d9d702a4906fa0a08cc5588c4b3138c8170a1
EXPO_PUBLIC_USER_SERVICE_API_KEY=ea2a45bbaa25e45f2bb8f1cb2d7997f19524a5edbae5f9d476053577e17bd8c9
```

**–í–ê–ñ–õ–ò–í–û**: –ö–æ–∂–µ–Ω backend —Å–µ—Ä–≤—ñ—Å –º–∞—î —Å–≤—ñ–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π API –∫–ª—é—á –¥–ª—è –±–µ–∑–ø–µ–∫–∏!

## –ü–æ—Ç–æ—á–Ω–∏–π –°—Ç–∞—Ç—É—Å

### ‚úÖ –ü—Ä–∞—Ü—é—î
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ production —Å–µ—Ä–≤—ñ—Å—ñ–≤
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–ª–æ–≥—ñ–Ω –ø—Ä–∞—Ü—é—î, –ø–æ–≤–µ—Ä—Ç–∞—î 200 OK)
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—É —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ AsyncStorage
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- ‚úÖ –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø—ñ—Å–ª—è –ª–æ–≥—ñ–Ω—É (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ /projects)
- ‚úÖ AuthGuard –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î —Å—Ç–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

### üîç –ü–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
- ‚ö†Ô∏è Project Service –æ—Ç—Ä–∏–º—É—î 401 –ø—Ä–∏ –∑–∞–ø–∏—Ç–∞—Ö
- ‚ö†Ô∏è Task Service –æ—Ç—Ä–∏–º—É—î 401 –ø—Ä–∏ –∑–∞–ø–∏—Ç–∞—Ö

**–ú–æ–∂–ª–∏–≤–∞ –ø—Ä–∏—á–∏–Ω–∞**: Bearer token –º–æ–∂–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–±–æ backend –æ—á—ñ–∫—É—î —ñ–Ω—à–∏–π —Ñ–æ—Ä–º–∞—Ç.

**–ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏**:
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ headers
2. –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ token –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ backend —Å–µ—Ä–≤—ñ—Å–∏ –æ—á—ñ–∫—É—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ headers

## –õ–æ–≥—É–≤–∞–Ω–Ω—è

–î–æ–¥–∞—Ç–æ–∫ —Ç–µ–ø–µ—Ä –ª–æ–≥—É—î:
- üìç Service URLs –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É
- üîê –°–ø—Ä–æ–±–∏ –ª–æ–≥—ñ–Ω—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó (–∑ email/username, –±–µ–∑ –ø–∞—Ä–æ–ª—è)
- ‚úÖ –°—Ç–∞—Ç—É—Å —É—Å–ø—ñ—Ö—É/–ø–æ–º–∏–ª–∫–∏
- üìä –î–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ (status code, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è)
- üîë –ù–∞—è–≤–Ω—ñ—Å—Ç—å Authorization —Ç–∞ API Key headers –≤ –∑–∞–ø–∏—Ç–∞—Ö
- üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- üß≠ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è AuthGuard

## –Ø–∫ –¢–µ—Å—Ç—É–≤–∞—Ç–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Expo —Å–µ—Ä–≤–µ—Ä** (—â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è):
   ```bash
   # Ctrl+C –¥–ª—è –∑—É–ø–∏–Ω–∫–∏
   npx expo start
   ```

2. **–£–≤—ñ–π—Ç–∏ –∑ —ñ—Å–Ω—É—é—á–∏–º–∏ credentials**:
   - Email: vovaexim@gmail.com
   - Password: [–≤–∞—à –ø–∞—Ä–æ–ª—å]

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏** –≤ –∫–æ–Ω—Å–æ–ª—ñ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
```
AuthProvider (Context)
    ‚Üì
useAuth() hook
    ‚Üì
All components (login, signup, tabs, etc.)
```

### –ü–æ—Ç—ñ–∫ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å credentials
2. `login()` –≤–∏–∫–ª–∏–∫–∞—î `authService.login()`
3. –ü—Ä–∏ —É—Å–ø—ñ—Ö—É: –∑–±–µ—Ä—ñ–≥–∞—î token + user –≤ AsyncStorage
4. –û–Ω–æ–≤–ª—é—î –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω —á–µ—Ä–µ–∑ `setToken()` —ñ `setUser()`
5. `AuthGuard` —Ä–µ–∞–≥—É—î –Ω–∞ –∑–º—ñ–Ω—É `isAuthenticated`
6. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/(tabs)/projects`

### Headers –≤ –ó–∞–ø–∏—Ç–∞—Ö
–ö–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –¥–æ backend –≤–∫–ª—é—á–∞—î:
- `Content-Type: application/json`
- `X-Service-API-Key: [API_KEY]` - –¥–ª—è service-to-service auth
- `Authorization: Bearer [TOKEN]` - –¥–ª—è user auth (–¥–æ–¥–∞—î—Ç—å—Å—è –≤ –∫–æ–∂–Ω–æ–º—É –º–µ—Ç–æ–¥—ñ)
